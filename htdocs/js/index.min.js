var saveAs=saveAs||function(s){"use strict";if(!(void 0===s||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var e=s.document,l=function(){return s.URL||s.webkitURL||s},c=e.createElementNS("http://www.w3.org/1999/xhtml","a"),d="download"in c,u=/constructor/i.test(s.HTMLElement)||s.safari,m=/CriOS\/[\d]+/.test(navigator.userAgent),g=function(e){(s.setImmediate||s.setTimeout)(function(){throw e},0)},t=4e4,v=function(e){setTimeout(function(){"string"==typeof e?l().revokeObjectURL(e):e.remove()},t)},f=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},n=function(e,a,t){t||(e=f(e));var n,o=this,r="application/octet-stream"===e.type,i=function(){!function(e,t,a){for(var n=(t=[].concat(t)).length;n--;){var o=e["on"+t[n]];if("function"==typeof o)try{o.call(e,a||e)}catch(e){g(e)}}}(o,"writestart progress write writeend".split(" "))};if(o.readyState=o.INIT,d)return n=l().createObjectURL(e),void setTimeout(function(){var e,t;c.href=n,c.download=a,e=c,t=new MouseEvent("click"),e.dispatchEvent(t),i(),v(n),o.readyState=o.DONE});!function(){if((m||r&&u)&&s.FileReader){var t=new FileReader;return t.onloadend=function(){var e=m?t.result:t.result.replace(/^data:[^;]*;/,"data:text/calendar;charset=utf8;");s.open(e,"_blank")||(s.location.href=e),e=void 0,o.readyState=o.DONE,i()},t.readAsDataURL(e),o.readyState=o.INIT}n=n||l().createObjectURL(e),!r&&s.open(n,"_blank")||(s.location.href=n),o.readyState=o.DONE,i(),v(n)}()},e=n.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,a){return t=t||e.name||"download",a||(e=f(e)),navigator.msSaveOrOpenBlob(e,t)}:(e.abort=function(){},e.readyState=e.INIT=0,e.WRITING=1,e.DONE=2,e.error=e.onwritestart=e.onprogress=e.onwrite=e.onabort=e.onerror=e.onwriteend=null,function(e,t,a){return new n(e,t||e.name||"download",a)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);"undefined"!=typeof module&&module.exports?module.exports.saveAs=saveAs:"undefined"!=typeof define&&null!==define&&null!==define.amd&&define("FileSaver.js",function(){return saveAs});var ics=function(y,e){"use strict";if(!(-1<navigator.userAgent.indexOf("MSIE")&&-1==navigator.userAgent.indexOf("MSIE 10"))){void 0===y&&(y="default"),void 0===e&&(e="Calendar");var C=(navigator.appVersion.indexOf("Win"),"\r\n"),w=[],o=["BEGIN:VCALENDAR","PRODID:"+e,"VERSION:2.0"].join(C),r=C+"END:VCALENDAR",D=["SU","MO","TU","WE","TH","FR","SA"];return{events:function(){return w},calendar:function(){return o+C+w.join(C)+r},addEvent:function(e,t,a,n,o,r){if(void 0===e||void 0===t||void 0===a||void 0===n||void 0===o)return!1;if(r&&!r.rrule){if("YEARLY"!==r.freq&&"MONTHLY"!==r.freq&&"WEEKLY"!==r.freq&&"DAILY"!==r.freq)throw"Recurrence rrule frequency must be provided and be one of the following: 'YEARLY', 'MONTHLY', 'WEEKLY', or 'DAILY'";if(r.until&&isNaN(Date.parse(r.until)))throw"Recurrence rrule 'until' must be a valid date string";if(r.interval&&isNaN(parseInt(r.interval)))throw"Recurrence rrule 'interval' must be an integer";if(r.count&&isNaN(parseInt(r.count)))throw"Recurrence rrule 'count' must be an integer";if(void 0!==r.byday){if("[object Array]"!==Object.prototype.toString.call(r.byday))throw"Recurrence rrule 'byday' must be an array";if(7<r.byday.length)throw"Recurrence rrule 'byday' array must not be longer than the 7 days in a week";for(var i in r.byday=r.byday.filter(function(e,t){return r.byday.indexOf(e)==t}),r.byday)if(D.indexOf(r.byday[i])<0)throw"Recurrence rrule 'byday' values must include only the following: 'SU', 'MO', 'TU', 'WE', 'TH', 'FR', 'SA'"}}var s=new Date(n),l=new Date(o),c=new Date,d=("0000"+s.getFullYear().toString()).slice(-4),u=("00"+(s.getMonth()+1).toString()).slice(-2),m=("00"+s.getDate().toString()).slice(-2),g=("00"+s.getHours().toString()).slice(-2),v=("00"+s.getMinutes().toString()).slice(-2),f=("00"+s.getSeconds().toString()).slice(-2),x=("0000"+l.getFullYear().toString()).slice(-4),V=("00"+(l.getMonth()+1).toString()).slice(-2),h=("00"+l.getDate().toString()).slice(-2),p=("00"+l.getHours().toString()).slice(-2),n=("00"+l.getMinutes().toString()).slice(-2),o=("00"+l.getMinutes().toString()).slice(-2),s="",l="";g+v+f+p+n+o!=0&&(s="T"+g+v+f,l="T"+p+n+o);var E,s=d+u+m+s,h=x+V+h+l,l=("0000"+c.getFullYear().toString()).slice(-4)+("00"+(c.getMonth()+1).toString()).slice(-2)+("00"+c.getDate().toString()).slice(-2)+"T"+("00"+c.getHours().toString()).slice(-2)+("00"+c.getMinutes().toString()).slice(-2)+("00"+c.getMinutes().toString()).slice(-2);r&&(r.rrule?E=r.rrule:(E="rrule:FREQ="+r.freq,r.until&&(E+=";UNTIL="+(c=new Date(Date.parse(r.until)).toISOString()).substring(0,c.length-13).replace(/[-]/g,"")+"000000Z"),r.interval&&(E+=";INTERVAL="+r.interval),r.count&&(E+=";COUNT="+r.count),r.byday&&0<r.byday.length&&(E+=";BYDAY="+r.byday.join(",")))),(new Date).toISOString();e=["BEGIN:VEVENT","UID:"+w.length+"@"+y,"CLASS:PUBLIC","DESCRIPTION:"+t,"DTSTAMP;VALUE=DATE-TIME:"+l,"DTSTART;VALUE=DATE-TIME:"+s+"Z","DTEND;VALUE=DATE-TIME:"+h+"Z","LOCATION:"+a,"SUMMARY;LANGUAGE=en-us:"+e,"TRANSP:TRANSPARENT","END:VEVENT"];return E&&e.splice(4,0,E),e=e.join(C),w.push(e),e},download:function(e,t){if(w.length<1)return!1;t=void 0!==t?t:".ics",e=void 0!==e?e:"calendar";var a=o+C+w.join(C)+r,n=-1===navigator.userAgent.indexOf("MSIE 10")?new Blob([a]):((n=new BlobBuilder).append(a),n.getBlob("text/x-vCalendar;charset="+document.characterSet));return saveAs(n,e+t),a},build:function(){return!(w.length<1)&&o+C+w.join(C)+r}}}console.log("Unsupported Browser")},Vax={Configs:null,Events:[],Cal:[],Map:null,Markers:[],AddressMarker:null,i:null,isAPhone:!1,convertDateToUTC:function(e){return new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds())},initialize:function(){"Google"===Vax.Configs.Source?$.when($.getJSON("https://sheets.googleapis.com/v4/spreadsheets/"+Vax.Configs.Data.Google.sheet.id+"/values/"+Vax.Configs.Data.Google.sheet.values+"?majorDimension="+Vax.Configs.Data.Google.sheet.majorDimension+"&key="+Vax.Configs.Data.Google.key,function(e){let t=e.values.shift();Vax.Events=e.values.map(function(n){return t.reduce(function(e,t,a){return e[t]=n[a],e},{})})})).then(Vax.setMap):"CityOfChicago"===Vax.Configs.Source?$.when($.getJSON(Vax.Configs.Data.CityOfChicago.url,function(e){for(const t of e){let e=Object.keys(Vax.Configs.Data.CityOfChicago.alias);e.forEach(e=>{void 0===t[Vax.Configs.Data.CityOfChicago.alias[e]]?t[e]="":t[e]=t[Vax.Configs.Data.CityOfChicago.alias[e]]}),"Senior Center- Central West Regional"===t.facility_name&&console.log(t)}Vax.Events=e})).then(Vax.setMap):($("#modal-error-title").html(Vax.Configs.Modal.errordata.title),$("#modal-error-body-instructions").html(Vax.Configs.Modal.errordata.instructions),$("#modal-error").modal("show"),gtag("event","Error",{event_label:"Error-Data",event_category:"Error no valid data source."})),$("#header-brand").text(Vax.Configs.Brand.header),""===Vax.Configs.Brand.footerURL?$("#footer-brand").text(Vax.Configs.Brand.footer):$("#footer-brand").html('<a id="footer-brand-link" href="'+Vax.Configs.Brand.footerURL+'" target="_blank">'+Vax.Configs.Brand.footer+"</a>"),(0<$("a[href*='tel:']").length||matchMedia("(hover: none), (pointer: coarse)").matches)&&(Vax.isAPhone=!0),$("#help").on("click",function(){$("#modal-help-title").html(Vax.Configs.Modal.help.title),$("#modal-help-body-instructions").html(Vax.Configs.Modal.help.instructions),$("#modal-help").modal("show"),gtag("event","Button",{event_label:"Help",event_category:"Open help text"})}),$("#about").on("click",function(){$("#modal-about-title").html(Vax.Configs.Modal.about.title),$("#modal-about-body-instructions").html(Vax.Configs.Modal.about.instructions),$("#modal-about").modal("show"),gtag("event","Button",{event_label:"About",event_category:"Open about text"})}),$("#search").on("click",function(){"Search"===$("#search").text()?($("#modal-search-title").html(Vax.Configs.Modal.search.title),$("#modal-search-body-instructions").html(Vax.Configs.Modal.search.instructions),$("#modal-search").modal("show"),gtag("event","Button",{event_label:"Search",event_category:"Open search modal"})):gtag("event","Button",{event_label:"Reset",event_category:"Reset map markers"}),Vax.resetMarkers()}),$("#modal-search-search").on("click",function(){""===$("#modal-search-date").val()&&$("#modal-search-date").val(new Intl.DateTimeFormat("en-US",{weekday:"short",year:"numeric",month:"long",day:"numeric"}).format(new Date)),Vax.searchByDate(new Date($("#modal-search-date").val()),null),gtag("event","Button",{event_label:"Search",event_category:$("#modal-search-date").val()})}),$("#modal-search-today").on("click",function(){var e=new Date;$("#modal-search-date").val(new Intl.DateTimeFormat("en-US",{weekday:"short",year:"numeric",month:"long",day:"numeric"}).format(e)),Vax.searchByDate(e,null),gtag("event","Button",{event_label:"Search",event_category:"Today"})}),$("#modal-search-tomorrow").on("click",function(){let e=new Date;e.setDate(e.getDate()+1),$("#modal-search-date").val(new Intl.DateTimeFormat("en-US",{weekday:"short",year:"numeric",month:"long",day:"numeric"}).format(e)),Vax.searchByDate(e,null),gtag("event","Button",{event_label:"Search",event_category:"Tomorrow"})}),$("#modal-search-weekend").on("click",function(){let e=new Date;e.setDate(e.getDate()+(7-e.getDay()+6)%7);let t=new Date;t.setDate(e.getDate()+1),$("#modal-search-date").val(new Intl.DateTimeFormat("en-US",{weekday:"short",year:"numeric",month:"long",day:"numeric"}).format(e)),Vax.searchByDate(e,t),gtag("event","Button",{event_label:"Search",event_category:"Weekend"})}),$("#modal-search-free").on("click",function(){for(let t=0;t<Vax.Events.length;t++){let e=!1;-1<Vax.Events[t].CostText.indexOf("No cost")&&(e=!0),!1===e&&Vax.Markers[t].setVisible(!1)}$("#search").html("Reset").removeClass("btn-custom").addClass("btn-danger"),gtag("event","Button",{event_label:"Search",event_category:"Free Events"})}),$("#modal-search-date,#modal-search-date-append").datetimepicker({format:"ddd, LL",ignoreReadonly:!0})},loadScript:function(){$.when($.getJSON("js/configure.json",function(e){Vax.Configs=e})).then(function(){let e=document.createElement("script");e.type="text/javascript",e.src="https://maps.googleapis.com/maps/api/js?key="+Vax.Configs.Data.Google.key+"&callback=Vax.initialize",document.body.appendChild(e)})},matchDays:function(e,t){switch(t){case new Intl.DateTimeFormat("en-US",{weekday:"long"}).format(e):case new Intl.DateTimeFormat("en-US",{weekday:"short"}).format(e):case new Intl.DateTimeFormat("en-US",{weekday:"narrow"}).format(e):return!0;default:return!1}},replaceURLs:function(e){if(e)return e.replace(/(((https?:\/\/)|(www|getvaxchi\.))[^\s]+)/g,function(e){let t=e;return t.match("^https?://")||(t="http://"+t),'<a href="'+t+'" target="_blank" rel="noopener noreferrer">'+e+"</a>"})},resetMarkers:function(){for(Vax.i=0;Vax.i<Vax.Events.length;Vax.i++)Vax.Markers[Vax.i].setVisible(!0);$("#search").html("Search").removeClass("btn-danger").addClass("btn-custom"),$("#modal-search-date").val("")},searchByDate:function(n,o){for(Vax.i=0;Vax.i<Vax.Events.length;Vax.i++){let e=!1,t=new Date(Vax.Events[Vax.i].BeginDate),a=new Date(Vax.Events[Vax.i].EndDate);if(n.setHours(12,0,0,0)>t.setHours(0,0,0,0)&&n<a.setHours(23,59,59,999))if(0===Vax.Events[Vax.i].RecurrenceDays.length)e=!0;else for(const r of Vax.Events[Vax.i].RecurrenceDays.split(","))if(Vax.matchDays(n,r.replace(/ /g,""))){e=!0;break}if(!1===e&&null!==o&&o.setHours(12,0,0,0)>t.setHours(0,0,0,0)&&o<a.setHours(23,59,59,59))if(0===Vax.Events[Vax.i].RecurrenceDays.length)e=!0;else for(const i of Vax.Events[Vax.i].RecurrenceDays.split(","))if(Vax.matchDays(o,i.replace(/ /g,""))){e=!0;break}!1===e&&Vax.Markers[Vax.i].setVisible(!1)}$("#search").html("Reset").removeClass("btn-custom").addClass("btn-danger")},setFindMeControl:function(e){e.className+="find-me-div";let t=document.createElement("div");t.className+="find-me-ui",t.title="Click to find your location.",e.appendChild(t);let a=document.createElement("div");a.className+="find-me-text",a.innerHTML="Find Me",t.appendChild(a);let n=new google.maps.Geocoder;google.maps.event.addDomListener(t,"click",function(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(e){e=new google.maps.LatLng(e.coords.latitude,e.coords.longitude);n.geocode({location:e},function(t,e){if("OK"===e&&t instanceof Array)for(let e=0;t[0].address_components.length;e++)if(t[0].address_components[e].types.includes("postal_code")){gtag("event","Button",{event_label:"Find Me",event_category:t[0].address_components[e].short_name});break}}),Vax.Map.setCenter(e),Vax.Map.setZoom(Vax.Configs.Map.zoom),null===Vax.AddressMarker?Vax.AddressMarker=new google.maps.Marker({position:e,map:Vax.Map,icon:{url:"img/yellow.png",scaledSize:new google.maps.Size(32,32)},clickable:!1}):(Vax.AddressMarker.setPosition(e),null===Vax.AddressMarker.getMap()&&Vax.AddressMarker.setMap(Map.Map))},function(){$("#modal-error-title").html(Vax.Configs.Modal.errorlocate.title),$("#modal-error-body-instructions").html(Vax.Configs.Modal.errorlocate.instructions),$("#modal-error").modal("show"),gtag("event","Error",{event_label:"Error-Data",event_category:"Error no valid data source."})},{timeout:5e3,enableHighAccuracy:!0})})},setMap:function(){for(Vax.Map=new google.maps.Map(document.getElementById("map"),{zoom:Vax.Configs.Map.zoom,center:Vax.Configs.Map.center,styles:Vax.Configs.Map.styles,clickableIcons:Vax.Configs.Map.clickableIcons,mapTypeControl:Vax.Configs.Map.mapTypeControl,panControl:Vax.Configs.Map.panControl,streetViewControl:Vax.Configs.Map.streetViewControl,zoomControl:Vax.Configs.Map.zoomControl,maxZoom:Vax.Configs.Map.maxZoom,minZoom:Vax.Configs.Map.minZoom,zoomControlOptions:{position:google.maps.ControlPosition.RIGHT_TOP},fullscreenControl:Vax.Configs.Map.fullscreenControl}),Vax.i=0;Vax.i<Vax.Events.length;Vax.i++){let e=new Date(Vax.Events[Vax.i].EndDate);e.setHours(23,59,59,59),e<new Date?Vax.Markers[Vax.i]=new google.maps.Marker({position:new google.maps.LatLng(Vax.Events[Vax.i].Latitude,Vax.Events[Vax.i].Longitude),map:Vax.Map,icon:{url:"img/grey.png",scaledSize:new google.maps.Size(32,32)},opacity:.67}):-1<Vax.Events[Vax.i].CostText.indexOf("No cost")?Vax.Markers[Vax.i]=new google.maps.Marker({position:new google.maps.LatLng(Vax.Events[Vax.i].Latitude,Vax.Events[Vax.i].Longitude),map:Vax.Map,icon:{url:"img/red.png",scaledSize:new google.maps.Size(32,32)}}):Vax.Markers[Vax.i]=new google.maps.Marker({position:new google.maps.LatLng(Vax.Events[Vax.i].Latitude,Vax.Events[Vax.i].Longitude),map:Vax.Map,icon:{url:"img/blue.png",scaledSize:new google.maps.Size(32,32)}}),google.maps.event.addListener(Vax.Markers[Vax.i],"click",function(n){return function(){$("#modal-event-detail-title").html(Vax.Events[n].LocationName);let a="",e=new Date(Vax.Events[n].EndDate);if(e.setHours(23,59,59,59),e<new Date&&(a+='<div class="alert alert-danger" role="alert">This date of this event has passed. Look for red or blue event pins on the map.</div>'),a+="<p>"+Vax.Events[n].Address1,""!==Vax.Events[n].Address2.trim()&&(a+=" "+Vax.Events[n].Address2),a+="<br>"+Vax.Events[n].City+", "+Vax.Events[n].State+" "+Vax.Events[n].PostalCode,(""!==Vax.Events[n].Phone||""!==Vax.Events[n].Contact)&&(a+="<br>",""!==Vax.Events[n].Contact&&(a+="Contact: "+Vax.Events[n].Contact),""!==Vax.Events[n].Phone&&""!==Vax.Events[n].Contact&&(a+=" at "),""!==Vax.Events[n].Phone))if(Vax.isAPhone){let e=Vax.Events[n].Phone;let t=e.replace(/[^0-9]/gm,"");"1"!==t.charAt(0)&&10===t.length&&(t="1"+t),a+='<a href="tel:+'+t+'">'+Vax.Events[n].Phone+"</a>"}else a+=Vax.Events[n].Phone;""!==Vax.Events[n].Url&&(a+='<br><a href="'+Vax.Events[n].Url+'" target="_blank">'+Vax.Events[n].Url+"</a>"),Vax.Events[n].BeginDate===Vax.Events[n].EndDate?(a+="<hr>"+new Intl.DateTimeFormat("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}).format(new Date(Vax.Events[n].BeginDate)),a+="<br>Hours: "+new Intl.DateTimeFormat("en-US",{hour:"numeric",minute:"2-digit"}).format(new Date(Vax.Events[n].BeginDateTime))+" to "+new Intl.DateTimeFormat("en-US",{hour:"numeric",minute:"2-digit"}).format(new Date(Vax.Events[n].EndDateTime)),Vax.Cal[n]=ics(),Vax.Cal[n].addEvent(Vax.Events[n].LocationName,Vax.Events[n].CostText+" "+Vax.Events[n].Contact+" "+Vax.Events[n].Phone+" "+Vax.Events[n].Url,Vax.Events[n].Address1+" "+Vax.Events[n].Address2+" "+Vax.Events[n].City+", "+Vax.Events[n].State+" "+Vax.Events[n].PostalCode,new Intl.DateTimeFormat("en-US",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",timeZoneName:"short"}).format(Vax.convertDateToUTC(new Date(Vax.Events[n].BeginDateTime))).replace(",",""),new Intl.DateTimeFormat("en-US",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",timeZoneName:"short"}).format(Vax.convertDateToUTC(new Date(Vax.Events[n].EndDateTime))).replace(",","")),"Senior Center- Central West Regional"===Vax.Events[n].LocationName&&console.log(new Intl.DateTimeFormat("en-US",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"}).format(new Date(Vax.Events[n].BeginDateTime)).replace(",","")+" "+new Intl.DateTimeFormat("en-US",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"}).format(new Date(Vax.Events[n].EndDateTime)).replace(",","")),$("#modal-event-detail-ical").show().on("click",function(){Vax.Cal[n].download(),gtag("event","Button",{event_label:"Calendar",event_category:Vax.Events[n].LocationName+" - "+new Intl.DateTimeFormat("en-US",{year:"numeric",month:"numeric",day:"numeric"}).format(new Date(Vax.Events[n].BeginDateTime))}),$("#modal-event-detail-ical").off()})):(""!==Vax.Events[n].HoursText&&(a+="<hr>"+Vax.Events[n].HoursText),$("#modal-event-detail-ical").hide().off()),""!==Vax.Events[n].NotesText&&(a+="<hr>"+Vax.replaceURLs(Vax.Events[n].NotesText)),$("#modal-event-detail-directions").on("click",function(){gtag("event","Button",{event_label:"Directions",event_category:Vax.Events[n].LocationName+" - "+Vax.Events[n].Address1+" "+Vax.Events[n].Address2+" "+Vax.Events[n].City+", "+Vax.Events[n].State+" "+Vax.Events[n].PostalCode}),window.open("https://maps.google.com/?q="+Vax.Events[n].Address1+" "+Vax.Events[n].City+", "+Vax.Events[n].State+" "+Vax.Events[n].PostalCode+" "+Vax.Events[n].Country,"_blank"),$("#modal-event-detail-directions").off()});var t=Vax.Events[n].CostText.replace(/(http\S+html)/gm,' the <a href="$1" target="_blank">Flu Clinics in the City of Chicago</a> web page');a+="<hr>"+t,a+="</p>",$("#modal-event-detail-body").html(a),$("#modal-event-detail").modal("show"),gtag("event","Modal",{event_label:"Vaccination Detail",event_category:Vax.Events[n].LocationName+" - "+Vax.Events[n].Address1+" "+Vax.Events[n].Address2+" "+Vax.Events[n].City+", "+Vax.Events[n].State+" "+Vax.Events[n].PostalCode})}}((Vax.Markers[Vax.i],Vax.i)))}if(navigator.geolocation){let e=document.createElement("div");Vax.setFindMeControl(e),e.index=1,Vax.Map.controls[google.maps.ControlPosition.TOP_LEFT].push(e)}}};window.onload=Vax.loadScript;